10 REM *********************************
20 REM ** Listing 3.3 :               **
30 REM ** FIRST PARSER                **
40 REM *********************************
44 DIM G$(50),W$(50),R%(50),LA%(50) ,LB%(50) 
45 Z=0: W=1: S=W: C=Z 
48 CLS: PRINT TAB(8);"PARSER": PRINT TAB(8) ;"-----": PRINT 
50 PRINT "Input a sentence and then press RETURN:"
60 PRINT: INPUT S$: S$=" "+S$+" ": PRINT: PRINT S$ 
70 RESTORE 
80 R=Z 
90 F=Z: READ A$: IF A$="999" THEN GOTO 170 
100 IF RIGHT$(A$,W)=" " THEN A$=LEFT$(A$,LEN(A$)-W): GOTO 100 
101 REM removes trailing blanks. 
110 R = R+W 
120 FOR I=W TO LEN(A$)
130   IF MID$(A$,I,W) = "=" THEN G$(R)=LEFT$(A$,I-W): P=W: W$(R) =RIGHT$(A$,LEN(A$)-I): I=LEN(A$) 
140   NEXT I 
150 IF F=Z THEN G$(R)=G$(R-W): W$(R)=A$ 
160 GOTO 90 : REM get next item 
170 REM -- Implement replacement rules: 
180 Q=W: F=Z: S=W 
190 LS=LEN(S$) 
200 FOR I=Q TO LS
210   IF MID$(S$,1,W) <> " " THEN GOTO 270 
220   I=I+W 
230   FOR J=S TO R 
240     IF MID$(S$,1,LEN(W$(J))+W) <> W$(J)+" " THEN GOTO 260 
250     C=C+W: LA%(C)=I-W: LB%(C)=LS-LEN(W$(J))-I+W 
255     S$=LEFT$(S$, LA%(C))+G$(J)+RIGHT$(S$, LB%(C)) 
256     F=W: R%(C)=J: PRINT S$: J=R: I=LS 
260     NEXT J 
270   NEXT I 
280 C1=Z: C2=Z 
290 FOR I=2 TO LEN(S$)-W 
300   IF MID$(S$,I,W) = "<" THEN C1 = C1+W 
310   IF MIDS(S$,I,W) = ">" THEN C2 = C2+W 
320   NEXT I
330 IF C1=W AND C2=W AND LEFT$(S$,2)=" <" AND RIGHT$(S$,2)="> " THEN PRINT "Parsing Complete": GOTO 420 
340 IF F=W THEN GOTO 170 
350 REM -- Back up the parse tree: 
360 PRINT "Backing up ...."
370 IF C=Z THEN PRINT "I cannot parse this -- sorry!": GOTO 420 
380 Q=LA%(C): S=R$(C) + W 
390 S$=LEFT$(S$,Q) + W$(S-W) + RIGHT$(S$,LB%(C)) 
400 C=C-W
410 GOTO 190 
420 PRINT 
444 END 
999 :
1000 REM Rules of grammar: 
1001 REM Note that no spaces are allowed except where shown: 
1010 DATA <SENTENCE>=<NOUN.PHRASE> <VERB.PHRASE-PREPOSITIONAL.PHRASES> 
1020 DATA <SENTENCE>=<SENTENCE> <CONJUNCTION> <SENTENCE>
1030 DATA <NOUN.PHRASE>=<DETERMINER> <ADJECTIVES-NOUN> 
1040 DATA <ADJECTIVES-NOUN>=<ADJECTIVE> <ADJECTIVES-NOUN> 
1050 DATA <ADJECTIVES-NOUN>=<NOUN> 
1060 DATA <VERB. PHRASE-PRE POSITIONAL. PHRASES>=<VERB.PHRASE-PREPOSITIONAL.PHRASES> <PREPOSITIONAL.PHRASE> 
1070 DATA <VERB. PHRASE-PREPOSITIONAL. PHRASES>=<VERB.PHRASE> 
1080 DATA <VERB.PHRASE>=<VERB> <NOUN.PHRASE> 
1090 DATA <VERB.PHRASE-PREPOSITIONAL. PHRASES>=<VERB> <PREPOSITIONAL.PHRASE> 
1100 DATA <PREPOSITIONAL. PHRASE>=<PREPOSITION> <NOUN.PHRASE> 
1110 DATA <VERB.PHRASE>=<VERB> 
1120 DATA <DETERMINER>=A,THE,THIS,THAT 
1130 DATA <ADJECTIVE>=GREEN,RED,STRONG 
1140 DATA <NOUN>=ROSE,GRASS,SUN 
1150 DATA <VERB>=GREW, SHONE 
1160 DATA <PREPOSITION>=TO,OF 


















NATURAL LANGUAGE 





1170 DATA <CONJUNCTION>=AND 
1180 DATA 999 
1190 REM 999 is stop code. 